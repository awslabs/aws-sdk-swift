//
// Copyright Amazon.com Inc. or its affiliates.
// All Rights Reserved.
//
// SPDX-License-Identifier: Apache-2.0
//

// Code generated by smithy-swift-codegen. DO NOT EDIT!

@testable import AWSS3
import ClientRuntime
import Smithy
import SmithyTestUtil
import XCTest


class DeleteObjectTaggingRequestTest: HttpRequestTestBase {
    /// S3 clients should escape special characters in Object Keys when the Object Key is used as a URI label binding.
    func testProtocol_S3EscapeObjectKeyInUriLabel() async throws {
        let expected = buildExpectedHttpRequest(
            method: .delete,
            path: "/my%20key.txt",
            queryParams: [
                "tagging"
            ],
            body: nil,
            host: "s3.us-west-2.amazonaws.com",
            resolvedHost: "mybucket.s3.us-west-2.amazonaws.com"
        )

        let config = try await S3Client.S3ClientConfiguration()
        config.region = "us-west-2"
        config.httpClientEngine = ProtocolTestClient()
        config.idempotencyTokenGenerator = ProtocolTestIdempotencyTokenGenerator()
        let client = S3Client(config: config)

        let input = DeleteObjectTaggingInput(
            bucket: "mybucket",
            key: "my key.txt"
        )
        do {
            _ = try await client.deleteObjectTagging(input: input)
        } catch TestCheckError.actual(let actual) {
            try await self.assertEqual(expected, actual)
        }
    }
    /// S3 clients should preserve an Object Key representing a path when the Object Key is used as a URI label binding, but still escape special characters.
    func testProtocol_S3EscapePathObjectKeyInUriLabel() async throws {
        let expected = buildExpectedHttpRequest(
            method: .delete,
            path: "/foo/bar/my%20key.txt",
            queryParams: [
                "tagging"
            ],
            body: nil,
            host: "s3.us-west-2.amazonaws.com",
            resolvedHost: "mybucket.s3.us-west-2.amazonaws.com"
        )

        let config = try await S3Client.S3ClientConfiguration()
        config.region = "us-west-2"
        config.httpClientEngine = ProtocolTestClient()
        config.idempotencyTokenGenerator = ProtocolTestIdempotencyTokenGenerator()
        let client = S3Client(config: config)

        let input = DeleteObjectTaggingInput(
            bucket: "mybucket",
            key: "foo/bar/my key.txt"
        )
        do {
            _ = try await client.deleteObjectTagging(input: input)
        } catch TestCheckError.actual(let actual) {
            try await self.assertEqual(expected, actual)
        }
    }
}
