//
// Copyright Amazon.com Inc. or its affiliates.
// All Rights Reserved.
//
// SPDX-License-Identifier: Apache-2.0
//

// Code generated by smithy-swift-codegen. DO NOT EDIT!

@_spi(SmithyReadWrite) import ClientRuntime
import Foundation
import class SmithyHTTPAPI.HTTPResponse
@_spi(SmithyReadWrite) import class SmithyJSON.Reader
import enum ClientRuntime.ErrorFault
import enum Smithy.ClientError
@_spi(SmithyReadWrite) import enum SmithyReadWrite.ReadingClosures
import protocol AWSClientRuntime.AWSServiceError
import protocol ClientRuntime.HTTPError
import protocol ClientRuntime.ModeledError
@_spi(SmithyReadWrite) import protocol SmithyReadWrite.SmithyReader
@_spi(SmithyReadWrite) import struct AWSClientRuntime.RestJSONError
@_spi(UnknownAWSHTTPServiceError) import struct AWSClientRuntime.UnknownAWSHTTPServiceError
import struct Smithy.URIQueryItem
@_spi(SmithyTimestamps) import struct SmithyTimestamps.TimestampFormatter

/// You do not have sufficient permissions to perform this action.
public struct AccessDeniedException: ClientRuntime.ModeledError, AWSClientRuntime.AWSServiceError, ClientRuntime.HTTPError, Swift.Error, Swift.Sendable {

    public struct Properties: Swift.Sendable {
        public internal(set) var code: Swift.String? = nil
        public internal(set) var message: Swift.String? = nil
    }

    public internal(set) var properties = Properties()
    public static var typeName: Swift.String { "AccessDeniedException" }
    public static var fault: ClientRuntime.ErrorFault { .client }
    public static var isRetryable: Swift.Bool { false }
    public static var isThrottling: Swift.Bool { false }
    public internal(set) var httpResponse = SmithyHTTPAPI.HTTPResponse()
    public internal(set) var message: Swift.String?
    public internal(set) var requestID: Swift.String?

    public init(
        code: Swift.String? = nil,
        message: Swift.String? = nil
    ) {
        self.properties.code = code
        self.properties.message = message
    }
}

/// An internal service error occurred.
public struct InternalServiceErrorException: ClientRuntime.ModeledError, AWSClientRuntime.AWSServiceError, ClientRuntime.HTTPError, Swift.Error, Swift.Sendable {

    public struct Properties: Swift.Sendable {
        public internal(set) var code: Swift.String? = nil
        public internal(set) var message: Swift.String? = nil
    }

    public internal(set) var properties = Properties()
    public static var typeName: Swift.String { "InternalServiceErrorException" }
    public static var fault: ClientRuntime.ErrorFault { .server }
    public static var isRetryable: Swift.Bool { false }
    public static var isThrottling: Swift.Bool { false }
    public internal(set) var httpResponse = SmithyHTTPAPI.HTTPResponse()
    public internal(set) var message: Swift.String?
    public internal(set) var requestID: Swift.String?

    public init(
        code: Swift.String? = nil,
        message: Swift.String? = nil
    ) {
        self.properties.code = code
        self.properties.message = message
    }
}

/// The request was denied due to request throttling.
public struct TooManyRequestsException: ClientRuntime.ModeledError, AWSClientRuntime.AWSServiceError, ClientRuntime.HTTPError, Swift.Error, Swift.Sendable {

    public struct Properties: Swift.Sendable {
        public internal(set) var code: Swift.String? = nil
        public internal(set) var message: Swift.String? = nil
    }

    public internal(set) var properties = Properties()
    public static var typeName: Swift.String { "TooManyRequestsException" }
    public static var fault: ClientRuntime.ErrorFault { .client }
    public static var isRetryable: Swift.Bool { false }
    public static var isThrottling: Swift.Bool { false }
    public internal(set) var httpResponse = SmithyHTTPAPI.HTTPResponse()
    public internal(set) var message: Swift.String?
    public internal(set) var requestID: Swift.String?

    public init(
        code: Swift.String? = nil,
        message: Swift.String? = nil
    ) {
        self.properties.code = code
        self.properties.message = message
    }
}

/// The request contains invalid parameters or is malformed.
public struct ValidationException: ClientRuntime.ModeledError, AWSClientRuntime.AWSServiceError, ClientRuntime.HTTPError, Swift.Error, Swift.Sendable {

    public struct Properties: Swift.Sendable {
        public internal(set) var code: Swift.String? = nil
        public internal(set) var message: Swift.String? = nil
    }

    public internal(set) var properties = Properties()
    public static var typeName: Swift.String { "ValidationException" }
    public static var fault: ClientRuntime.ErrorFault { .client }
    public static var isRetryable: Swift.Bool { false }
    public static var isThrottling: Swift.Bool { false }
    public internal(set) var httpResponse = SmithyHTTPAPI.HTTPResponse()
    public internal(set) var message: Swift.String?
    public internal(set) var requestID: Swift.String?

    public init(
        code: Swift.String? = nil,
        message: Swift.String? = nil
    ) {
        self.properties.code = code
        self.properties.message = message
    }
}

/// Request structure for checking revocation status.
public struct GetRevocationStatusInput: Swift.Sendable {
    /// List of certificate hashes to check for revocation.
    /// This member is required.
    public var certificateHashes: [Swift.String]?
    /// The ARN of the signing job that produced the signature.
    /// This member is required.
    public var jobArn: Swift.String?
    /// The platform identifier for the signing platform used.
    /// This member is required.
    public var platformId: Swift.String?
    /// The ARN of the signing profile version used to sign the artifact.
    /// This member is required.
    public var profileVersionArn: Swift.String?
    /// The timestamp when the artifact was signed, in ISO 8601 format.
    /// This member is required.
    public var signatureTimestamp: Foundation.Date?

    public init(
        certificateHashes: [Swift.String]? = nil,
        jobArn: Swift.String? = nil,
        platformId: Swift.String? = nil,
        profileVersionArn: Swift.String? = nil,
        signatureTimestamp: Foundation.Date? = nil
    ) {
        self.certificateHashes = certificateHashes
        self.jobArn = jobArn
        self.platformId = platformId
        self.profileVersionArn = profileVersionArn
        self.signatureTimestamp = signatureTimestamp
    }
}

/// Response containing the list of revoked entities.
public struct GetRevocationStatusOutput: Swift.Sendable {
    /// List of entity identifiers that have been revoked. Empty if no revocations found.
    public var revokedEntities: [Swift.String]?

    public init(
        revokedEntities: [Swift.String]? = nil
    ) {
        self.revokedEntities = revokedEntities
    }
}

extension GetRevocationStatusInput {

    static func urlPathProvider(_ value: GetRevocationStatusInput) -> Swift.String? {
        return "/revocations"
    }
}

extension GetRevocationStatusInput {

    static func queryItemProvider(_ value: GetRevocationStatusInput) throws -> [Smithy.URIQueryItem] {
        var items = [Smithy.URIQueryItem]()
        guard let certificateHashes = value.certificateHashes else {
            let message = "Creating a URL Query Item failed. certificateHashes is required and must not be nil."
            throw Smithy.ClientError.unknownError(message)
        }
        certificateHashes.forEach { queryItemValue in
            let queryItem = Smithy.URIQueryItem(name: "certificateHashes".urlPercentEncoding(), value: Swift.String(queryItemValue).urlPercentEncoding())
            items.append(queryItem)
        }
        guard let profileVersionArn = value.profileVersionArn else {
            let message = "Creating a URL Query Item failed. profileVersionArn is required and must not be nil."
            throw Smithy.ClientError.unknownError(message)
        }
        let profileVersionArnQueryItem = Smithy.URIQueryItem(name: "profileVersionArn".urlPercentEncoding(), value: Swift.String(profileVersionArn).urlPercentEncoding())
        items.append(profileVersionArnQueryItem)
        guard let platformId = value.platformId else {
            let message = "Creating a URL Query Item failed. platformId is required and must not be nil."
            throw Smithy.ClientError.unknownError(message)
        }
        let platformIdQueryItem = Smithy.URIQueryItem(name: "platformId".urlPercentEncoding(), value: Swift.String(platformId).urlPercentEncoding())
        items.append(platformIdQueryItem)
        guard let jobArn = value.jobArn else {
            let message = "Creating a URL Query Item failed. jobArn is required and must not be nil."
            throw Smithy.ClientError.unknownError(message)
        }
        let jobArnQueryItem = Smithy.URIQueryItem(name: "jobArn".urlPercentEncoding(), value: Swift.String(jobArn).urlPercentEncoding())
        items.append(jobArnQueryItem)
        guard let signatureTimestamp = value.signatureTimestamp else {
            let message = "Creating a URL Query Item failed. signatureTimestamp is required and must not be nil."
            throw Smithy.ClientError.unknownError(message)
        }
        let signatureTimestampQueryItem = Smithy.URIQueryItem(name: "signatureTimestamp".urlPercentEncoding(), value: Swift.String(SmithyTimestamps.TimestampFormatter(format: .dateTime).string(from: signatureTimestamp)).urlPercentEncoding())
        items.append(signatureTimestampQueryItem)
        return items
    }
}

extension GetRevocationStatusOutput {

    static func httpOutput(from httpResponse: SmithyHTTPAPI.HTTPResponse) async throws -> GetRevocationStatusOutput {
        let data = try await httpResponse.data()
        let responseReader = try SmithyJSON.Reader.from(data: data)
        let reader = responseReader
        var value = GetRevocationStatusOutput()
        value.revokedEntities = try reader["revokedEntities"].readListIfPresent(memberReadingClosure: SmithyReadWrite.ReadingClosures.readString(from:), memberNodeInfo: "member", isFlattened: false)
        return value
    }
}

enum GetRevocationStatusOutputError {

    static func httpError(from httpResponse: SmithyHTTPAPI.HTTPResponse) async throws -> Swift.Error {
        let data = try await httpResponse.data()
        let responseReader = try SmithyJSON.Reader.from(data: data)
        let baseError = try AWSClientRuntime.RestJSONError(httpResponse: httpResponse, responseReader: responseReader, noErrorWrapping: false)
        if let error = baseError.customError() { return error }
        switch baseError.code {
            case "AccessDeniedException": return try AccessDeniedException.makeError(baseError: baseError)
            case "InternalServiceErrorException": return try InternalServiceErrorException.makeError(baseError: baseError)
            case "TooManyRequestsException": return try TooManyRequestsException.makeError(baseError: baseError)
            case "ValidationException": return try ValidationException.makeError(baseError: baseError)
            default: return try AWSClientRuntime.UnknownAWSHTTPServiceError.makeError(baseError: baseError)
        }
    }
}

extension AccessDeniedException {

    static func makeError(baseError: AWSClientRuntime.RestJSONError) throws -> AccessDeniedException {
        let reader = baseError.errorBodyReader
        var value = AccessDeniedException()
        value.properties.code = try reader["code"].readIfPresent()
        value.properties.message = try reader["message"].readIfPresent()
        value.httpResponse = baseError.httpResponse
        value.requestID = baseError.requestID
        value.message = baseError.message
        return value
    }
}

extension InternalServiceErrorException {

    static func makeError(baseError: AWSClientRuntime.RestJSONError) throws -> InternalServiceErrorException {
        let reader = baseError.errorBodyReader
        var value = InternalServiceErrorException()
        value.properties.code = try reader["code"].readIfPresent()
        value.properties.message = try reader["message"].readIfPresent()
        value.httpResponse = baseError.httpResponse
        value.requestID = baseError.requestID
        value.message = baseError.message
        return value
    }
}

extension TooManyRequestsException {

    static func makeError(baseError: AWSClientRuntime.RestJSONError) throws -> TooManyRequestsException {
        let reader = baseError.errorBodyReader
        var value = TooManyRequestsException()
        value.properties.code = try reader["code"].readIfPresent()
        value.properties.message = try reader["message"].readIfPresent()
        value.httpResponse = baseError.httpResponse
        value.requestID = baseError.requestID
        value.message = baseError.message
        return value
    }
}

extension ValidationException {

    static func makeError(baseError: AWSClientRuntime.RestJSONError) throws -> ValidationException {
        let reader = baseError.errorBodyReader
        var value = ValidationException()
        value.properties.code = try reader["code"].readIfPresent()
        value.properties.message = try reader["message"].readIfPresent()
        value.httpResponse = baseError.httpResponse
        value.requestID = baseError.requestID
        value.message = baseError.message
        return value
    }
}

public enum SignerDataClientTypes {}
